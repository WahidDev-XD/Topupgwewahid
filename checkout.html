<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout QRIS</title>

<style>
:root{
  --accent:#3b82f6;
  --bg:#020617;
  --card:rgba(15,23,42,.92);
  --text:#e5e7eb;
  --green:#22c55e;
  --red:#ef4444;
}

*{box-sizing:border-box}

body{
  margin:0;
  min-height:100vh;
  font-family:system-ui,Arial;
  background:radial-gradient(circle at top,#60a5fa,#020617);
  color:var(--text);
  display:flex;
  justify-content:center;
  align-items:center;
}

.box{
  width:95%;
  max-width:420px;
  background:var(--card);
  border-radius:26px;
  padding:22px;
  box-shadow:0 0 32px rgba(96,165,250,.45);
  text-align:center;
}

/* TITLE */
h3{
  margin-top:0;
  font-size:18px;
  letter-spacing:.5px;
}

/* LOADING */
#loading{
  margin:30px 0;
}
.spinner{
  width:48px;
  height:48px;
  border:4px solid var(--accent);
  border-top:4px solid transparent;
  border-radius:50%;
  animation:spin 1s linear infinite;
  margin:0 auto 12px;
}
@keyframes spin{
  to{transform:rotate(360deg)}
}

/* QRIS */
#qrisBox{
  display:none;
}
#qrisBox img{
  width:240px;
  border-radius:18px;
  box-shadow:0 0 20px rgba(96,165,250,.55);
}

/* DETAIL */
#detail{
  margin-top:16px;
  font-size:13px;
  line-height:1.7;
  background:#020617;
  border-radius:16px;
  padding:14px;
  text-align:left;
}

/* TIMER */
#timer{
  margin-top:10px;
  font-size:13px;
  color:#facc15;
}
#expired{
  display:none;
  color:var(--red);
  font-weight:800;
  margin-top:10px;
}

/* BUTTON */
button{
  width:100%;
  padding:14px;
  margin-top:16px;
  border:none;
  border-radius:18px;
  font-weight:900;
  cursor:pointer;
}
.wa{
  background:var(--green);
  color:#000;
}
.back{
  background:#1f2937;
  color:white;
}
</style>
</head>

<body>
<div class="box">

<h3>PEMBAYARAN QRIS</h3>

<!-- LOADING -->
<div id="loading">
  <div class="spinner"></div>
  Menyiapkan QRIS...
</div>

<!-- QRIS -->
<div id="qrisBox">
  <img src="qris.png">
  <p id="timer"></p>
  <p id="expired">QRIS KEDALUWARSA ❌</p>
</div>

<div id="detail"></div>

<button class="wa" id="waBtn">Konfirmasi via WhatsApp</button>
<button class="back" onclick="history.back()">Kembali</button>

</div>

<script>
const p = new URLSearchParams(location.search);
const game   = p.get("game") || "-";
const userid = p.get("userid") || "-";
const server = p.get("server") || "-";
const item   = p.get("item") || "-";
const price  = p.get("price") || 0;

/* DETAIL ORDER */
detail.innerHTML = `
<b>DETAIL PESANAN</b><br>
Game: ${game.toUpperCase()}<br>
User ID: ${userid}<br>
${game==="ml" ? "Server ID: "+server+"<br>" : ""}
Item: ${item}<br>
Harga: <b>Rp ${Number(price).toLocaleString("id-ID")}</b>
`;

/* LOADING */
setTimeout(()=>{
  loading.style.display="none";
  qrisBox.style.display="block";
},2000);

/* TIMER 5 MENIT */
let t = 300;
const interval = setInterval(()=>{
  t--;
  if(t <= 0){
    clearInterval(interval);
    timer.style.display="none";
    expired.style.display="block";
    waBtn.disabled = true;
    waBtn.textContent = "QRIS EXPIRED";
    waBtn.style.opacity = .6;
    return;
  }
  timer.textContent = `⏳ Menunggu pembayaran ${Math.floor(t/60)}:${String(t%60).padStart(2,"0")}`;
},1000);

/* WHATSAPP */
waBtn.onclick = ()=>{
  const msg = `Halo Admin,
Saya sudah melakukan pembayaran.

Game: ${game.toUpperCase()}
User ID: ${userid}
${game==="ml" ? "Server ID: "+server : ""}
Item: ${item}
Harga: Rp ${Number(price).toLocaleString("id-ID")}`;

  window.open("https://wa.me/6282195594060?text="+encodeURIComponent(msg));
};
</script>
</body>
</html>
